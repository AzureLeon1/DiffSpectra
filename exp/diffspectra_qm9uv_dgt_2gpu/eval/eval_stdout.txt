INFO - run_lib.py - 2025-06-09 11:13:51,207 - model size: 116.2MB
INFO - run_lib.py - 2025-06-09 11:13:51,220 - loading training mols
INFO - run_lib.py - 2025-06-09 11:14:11,582 - loading test mols
INFO - run_lib.py - 2025-06-09 11:14:17,208 - build EDM metric
INFO - run_lib.py - 2025-06-09 11:14:22,746 - build EDM 2D metric
INFO - run_lib.py - 2025-06-09 11:14:27,387 - build mose metric
INFO - run_lib.py - 2025-06-09 11:14:44,310 - build sub geometry metric
INFO - run_lib.py - 2025-06-09 11:14:44,356 - load checkpoint: exp/diffspectra_qm9uv_dgt_2gpu/checkpoints/checkpoint_40.pth
INFO - run_lib.py - 2025-06-09 11:14:44,935 - Sampling -- ckpt: 40
INFO - run_lib.py - 2025-06-09 12:52:29,737 - Sampling accomplished
INFO - run_lib.py - 2025-06-09 12:54:33,352 - Number of molecules: 10000
INFO - run_lib.py - 2025-06-09 12:54:33,353 - Metric-3D || atom stability: 0.9941, mol stability: 0.9479, validity: 0.9746, complete: 0.9720,
INFO - run_lib.py - 2025-06-09 12:55:42,368 - Metric-3D || FCD: 2.2338
INFO - run_lib.py - 2025-06-09 12:56:01,030 - Metric-2D || atom stability: 0.9993, mol stability: 0.9902, validity: 0.9927, complete: 0.9927, unique & valid: 0.8370, unique & valid & novelty: 0.8046
INFO - run_lib.py - 2025-06-09 12:57:10,896 - Metric-2D || FCD: 1.4299, SNN: 0.5099, Frag: 0.9096, Scaf: 0.7213, IntDiv: 0.8951
INFO - run_lib.py - 2025-06-09 13:04:59,400 - Metric-Align || Bond Length MMD: 0.2009, Bond Angle MMD: 0.0438, Dihedral Angle MMD: 0.005697
INFO - run_lib.py - 2025-06-09 13:04:59,400 - C1H: 0.0483 C1C: 0.0316 C1O: 0.0137 N1C: 0.0394 N1H: 0.3318 C2O: 0.0134 O1H: 1.1188 C2C: 0.0101 
INFO - run_lib.py - 2025-06-09 13:04:59,401 - C1C-C1H: 0.1258 C1C-C1C: 0.1125 C1C-C1O: 0.0264 C1C-C1N: 0.0074 C1N-N1C: 0.0207 C1O-O1C: 0.0103 O1C-C1H: 0.0217 C2C-C1C: 0.0258 
INFO - run_lib.py - 2025-06-09 13:04:59,401 - H1C-C1C-C1C: 0.0063 C1C-C1C-C1C: 0.0093 H1C-C1C-C1H: 0.0098 H1C-C1C-C1O: 0.0023 C1C-C1C-C1O: 0.0141 C1N-N1C-C1C: 0.0015 H1C-C1N-N1C: 0.0020 H1C-C1C-C1N: 0.0002 
INFO - run_lib.py - 2025-06-09 13:04:59,401 - Computing similarity metrics from compute_metrics.py
INFO - run_lib.py - 2025-06-09 13:04:59,401 - Computing 3D version similarity metrics
INFO - run_lib.py - 2025-06-09 13:05:02,114 - 3D分子对统计 - 输入: 10000, 有效: 9597, 跳过: 403
INFO - run_lib.py - 2025-06-09 13:21:12,379 - 3D similarity metrics saved to: exp/diffspectra_qm9uv_dgt_2gpu/eval/similarity_metrics_3d_ckpt_40.csv
INFO - run_lib.py - 2025-06-09 13:21:12,382 - 3D 精确匹配率: 0.0016
INFO - run_lib.py - 2025-06-09 13:21:12,382 - 3D Tanimoto相似度(平均): 0.1598
INFO - run_lib.py - 2025-06-09 13:21:12,382 - 3D Tanimoto(MACCS)相似度(平均): 0.3817
INFO - run_lib.py - 2025-06-09 13:21:12,383 - 3D Fraggle相似度(平均): 0.5636
INFO - run_lib.py - 2025-06-09 13:21:12,383 - 3D 余弦相似度(平均): 0.2677
INFO - run_lib.py - 2025-06-09 13:21:12,383 - 3D 近似匹配率(Tanimoto≥0.675): 0.0033
INFO - run_lib.py - 2025-06-09 13:21:12,384 - 3D 有效匹配率(Tanimoto≥0.4): 0.013
INFO - run_lib.py - 2025-06-09 13:21:12,384 - 3D 官能团相似度(平均): 0.4276
INFO - run_lib.py - 2025-06-09 13:21:12,384 - Successfully computed 3D metrics for 9597 molecule pairs
INFO - run_lib.py - 2025-06-09 13:21:12,388 - Computing 2D version similarity metrics
INFO - run_lib.py - 2025-06-09 13:21:14,312 - 2D分子对统计 - 输入: 10000, 有效: 9774, 跳过: 226
INFO - run_lib.py - 2025-06-09 13:33:01,430 - 2D similarity metrics saved to: exp/diffspectra_qm9uv_dgt_2gpu/eval/similarity_metrics_2d_ckpt_40.csv
INFO - run_lib.py - 2025-06-09 13:33:01,432 - 2D 精确匹配率: 0.002
INFO - run_lib.py - 2025-06-09 13:33:01,433 - 2D Tanimoto相似度(平均): 0.1637
INFO - run_lib.py - 2025-06-09 13:33:01,433 - 2D Tanimoto(MACCS)相似度(平均): 0.3881
INFO - run_lib.py - 2025-06-09 13:33:01,433 - 2D Fraggle相似度(平均): 0.5678
INFO - run_lib.py - 2025-06-09 13:33:01,433 - 2D 余弦相似度(平均): 0.2726
INFO - run_lib.py - 2025-06-09 13:33:01,434 - 2D 近似匹配率(Tanimoto≥0.675): 0.0044
INFO - run_lib.py - 2025-06-09 13:33:01,434 - 2D 有效匹配率(Tanimoto≥0.4): 0.0168
INFO - run_lib.py - 2025-06-09 13:33:01,434 - 2D 官能团相似度(平均): 0.4354
INFO - run_lib.py - 2025-06-09 13:33:01,434 - Successfully computed 2D metrics for 9774 molecule pairs
INFO - run_lib.py - 2025-06-09 13:33:02,481 - Molecules saved for analysis in: exp/diffspectra_qm9uv_dgt_2gpu/eval/molecules_ckpt_40

3D 相似度分布
Tanimoto相似度分布:            
相似度 0-0.2: 7276个 (75.82%)                                                                     
相似度 0.2-0.4: 2196个 (22.88%)
相似度 0.4-0.6: 92个 (0.96%)   
相似度 0.6-0.8: 2个 (0.02%)    
相似度 0.8-1.0: 0个 (0.00%)    
相似度 1.0: 31个 (0.32%)       
                               
Tanimoto(MACCS)相似度分布:     
相似度 0-0.2: 1074个 (11.19%)  
相似度 0.2-0.4: 4458个 (46.45%)
相似度 0.4-0.6: 3192个 (33.26%)
相似度 0.6-0.8: 738个 (7.69%)  
相似度 0.8-1.0: 98个 (1.02%)   
相似度 1.0: 37个 (0.39%)       

Fraggle相似度分布:                                                                                
相似度 0-0.2: 781个 (8.14%)                                                                       
相似度 0.2-0.4: 1570个 (16.36%)                                                                   
相似度 0.4-0.6: 3198个 (33.32%)                                                                   
相似度 0.6-0.8: 2181个 (22.73%)                                                                   
相似度 0.8-1.0: 1520个 (15.84%)                                                                   
相似度 1.0: 347个 (3.62%)

2D 相似度分布
Tanimoto相似度分布:                                                                               
相似度 0-0.2: 7219个 (73.86%)                                                                     
相似度 0.2-0.4: 2391个 (24.46%)                                                                   
相似度 0.4-0.6: 119个 (1.22%)                                                                     
相似度 0.6-0.8: 3个 (0.03%)                                                                       
相似度 0.8-1.0: 0个 (0.00%)                                                                       
相似度 1.0: 42个 (0.43%)                                                                          

Tanimoto(MACCS)相似度分布:                                                                        
相似度 0-0.2: 1089个 (11.14%)                                                                     
相似度 0.2-0.4: 4431个 (45.33%)                                                                   
相似度 0.4-0.6: 3217个 (32.91%)                                                                   
相似度 0.6-0.8: 862个 (8.82%)                                                                     
相似度 0.8-1.0: 123个 (1.26%)                                                                     
相似度 1.0: 52个 (0.53%)                                                                          

Fraggle相似度分布:                                                                                
相似度 0-0.2: 801个 (8.20%)                                                                       
相似度 0.2-0.4: 1539个 (15.75%)                                                                   
相似度 0.4-0.6: 3247个 (33.22%)                                                                   
相似度 0.6-0.8: 2212个 (22.63%)                                                                   
相似度 0.8-1.0: 1579个 (16.16%)                                                                   
相似度 1.0: 396个 (4.05%)